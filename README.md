# Лабораторная работа №2 — rb-dict (Elixir)
Силаев Захар Алексеевич, вариант rb-dict. Цель: разработать неизменяемый полиморфный словарь с поддержкой операций добавления/удаления, фильтрации, отображения, свёрток и свойств моноида. Реализация и тесты ориентированы на стиль, описанный в задании.

## Структура проекта
- `lib/rb_dict.ex` — основной модуль `Fplab1.RBDict`, описывающий узлы кортежами `{:node, color, key, value, left, right}`. Используется левостороннее красно-чёрное дерево: балансировка выполняется через явные операции `rotate_left/1`, `rotate_right/1`, `flip_colors/1`, `move_red_left/1`, `move_red_right/1`. API включает `new/0`, `put/3`, `delete/2`, `fetch/2`, `fetch!/2`, `get/3`, `member?/2`, `map/2`, `filter/2`, `foldl/3`, `foldr/3`, `from_enum/1`, `to_list/1`, `concat/2`, `concat/1`, `equal?/2`.
- Все функции высшего порядка повторяют стиль примера: прямые рекурсивные обходы дерева без сторонних абстракций, неизменяемость достигается за счёт возврата новых кортежей узлов.
- `equal?/2` реализует параллельный симметричный обход деревьев через собственный стек, что исключает преобразование структуры в списки.

## Основные операции
- **add (`put/3`)**: вычисляет базовую позицию по ключу, вставляет новую вершину, балансирует дерево и принудительно окрашивает корень в чёрный цвет.
- **delete (`delete/2`)**: реализует LLRB-алгоритм удаления с переносом красных ребёр (`move_red_left/right`) и дальнейшим `fix_up/1`.
- **filter/map**: операторы высшего порядка, выполняющиеся без протечки внутреннего представления; `filter/2` строит новый словарь из тех же пар, `map/2` пересчитывает значения и пересобирает дерево.
- **foldl/foldr**: свёртки в порядке возрастания/убывания ключей; реализованы рекурсивными обходами.
- **Monoid**: `new/0` — нейтральный элемент, `concat/2` и `concat/1` — ассоциативное объединение словарей с приоритетом правого аргумента. Свойства проверяются property-based тестами.

## Тестирование (`test/rb_dict_test.exs`)
### Unit
Покрывают базовые сценарии API: корректность `put/delete`, поведение `map`/`filter`, порядок обхода в `foldl`/`foldr`, инвариант `equal?/2`.

### Property-based (StreamData)
1. `from_enum/1` даёт тот же результат, что и стандартный `Map` (сравнение отсортированных списков пар).
2. `map/2` и `filter/2` эквивалентны своим списочным аналогам.
3. Моноидальные свойства (`identity`, `associativity`) и согласованность `foldl/3`, `foldr/3` с `Enum.reduce`.

## Запуск
```bash
mix deps.get
mix test
```
`mix test` выполняет unit и property-тесты, подтверждая корректность реализации.
